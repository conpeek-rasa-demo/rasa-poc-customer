version: "2.0"

stories:

# Assistance flow
- story: assistance request
  steps:
  - intent: connected
  - action: utter_greet
  - intent: assistance_request
  - action: utter_assistance_transfer

- story: claim report with assistance
  steps:
  - intent: connected
  - action: utter_greet
  - intent: claim_report
  - action: utter_give_assistance
  - intent: affirm
  - action: utter_assistance_transfer

# Claim flow
- story: claim report without customer info
  steps:
  - intent: connected
  - action: utter_greet
  - intent: claim_report
  - action: utter_give_assistance
  - intent: deny
  - action: customer_info_form
  - active_loop: customer_info_form
  - active_loop: null
  - slot_was_set:
    - confirm_customer_phone_number: false
  - action: utter_claim_transfer

- story: claim report with customer info
  steps:
  - intent: connected
  - action: utter_greet
  - intent: claim_report
  - action: utter_give_assistance
  - intent: deny
  - action: customer_info_form
  - active_loop: customer_info_form
  - active_loop: null
  - slot_was_set:
    - confirm_customer_phone_number: true
  - checkpoint: customer_info

- story: claim report without claim subject
  steps:
  - checkpoint: customer_info
  - action: action_set_subject_type
  - slot_was_set:
    - subject_type: null
  - action: utter_describe_incident
  - intent: claim_report
  - slot_was_set:
    - subject_type: null
  - action: utter_claim_transfer

- story: claim report with claim subject - path 1
  steps:
  - checkpoint: customer_info
  - action: action_set_subject_type
  - slot_was_set:
    - subject_type: null
  - action: utter_describe_incident
  - intent: claim_report
  - slot_was_set:
    - subject_type: "any"
  - checkpoint: subject_type

- story: claim report with claim subject - path 2
  steps:
  - checkpoint: customer_info
  - action: action_set_subject_type
  - slot_was_set:
    - subject_type: "any"
  - checkpoint: subject_type

- story: claim report gather data and transfer
  steps:
  - checkpoint: subject_type
  - action: action_init_claim_report
  - action: claim_report_form
  - active_loop: claim_report_form
  - active_loop: null
  - action: utter_claim_transfer

# Status flow
- story: status without incident number
  steps:
  - intent: connected
  - action: utter_greet
  - or:
    - intent: claim_status
    - intent: claim_status_consultant_direct
    - intent: claim_status_manager_message
    - intent: claim_status_bot_info_inspection
    - intent: claim_status_bot_info_documents
    - intent: claim_status_bot_info_withdrawal
  - action: action_set_status_path
  - action: utter_give_incident_number
  - intent: inform
  - action: action_get_incident_info
  - slot_was_set:
    - incident_number: null
  - action: utter_status_transfer

- story: status with incident number
  steps:
  - intent: connected
  - action: utter_greet
  - or:
    - intent: claim_status
    - intent: claim_status_consultant_direct
    - intent: claim_status_manager_message
    - intent: claim_status_bot_info_inspection
    - intent: claim_status_bot_info_documents
    - intent: claim_status_bot_info_withdrawal
  - action: action_set_status_path
  - action: utter_give_incident_number
  - intent: inform
  - action: action_get_incident_info
  - slot_was_set:
    - incident_number: "any"
  - action: action_set_status_path
  - checkpoint: clyrify_question

- story: status with clarifying
  steps:
  - checkpoint: clyrify_question
  - slot_was_set:
    - status_path: null
  - action: utter_clarify_question
  - or:
    - intent: claim_status
    - intent: claim_status_consultant_direct
    - intent: claim_status_manager_message
    - intent: claim_status_bot_info
  - action: action_set_status_path
  - action: customer_authentication_form
  - active_loop: customer_authentication_form
  - active_loop: null
  - action: action_perform_customer_authentication

- story: status without clarifying
  steps:
  - checkpoint: clyrify_question
  - slot_was_set:
    - status_path: "any"
  - action: customer_authentication_form
  - active_loop: customer_authentication_form
  - active_loop: null
  - action: action_perform_customer_authentication

- story: status authentication failed
  steps:
#  - checkpoint: customer_authentication
  - slot_was_set:
    - customer_authenticated: false
  - action: utter_status_transfer

- story: status authentication succeed - consultant direct
  steps:
#  - checkpoint: customer_authentication
  - slot_was_set:
    - customer_authenticated: true
  - action: action_set_status_path
  - slot_was_set:
    - status_path: "consultant_direct"
  - action: utter_status_transfer

- story: status authentication succeed - manager message
  steps:
#  - checkpoint: customer_authentication
  - slot_was_set:
    - customer_authenticated: true
  - action: action_set_status_path
  - slot_was_set:
    - status_path: "manager_message"
  - action: utter_status_message

- story: status authentication succeed - bot info inspection
  steps:
#  - checkpoint: customer_authentication
  - slot_was_set:
    - customer_authenticated: true
  - action: action_set_status_path
  - slot_was_set:
    - status_path: "bot_info_inspection"
  - action: action_select_utter_status_bot_info

- story: status authentication succeed - bot info documents
  steps:
#  - checkpoint: customer_authentication
  - slot_was_set:
    - customer_authenticated: true
  - action: action_set_status_path
  - slot_was_set:
    - status_path: "bot_info_documents"
  - action: action_select_utter_status_bot_info

- story: status authentication succeed - bot info withdrawal
  steps:
#  - checkpoint: customer_authentication
  - slot_was_set:
    - customer_authenticated: true
  - action: action_set_status_path
  - slot_was_set:
    - status_path: "bot_info_withdrawal"
  - action: action_select_utter_status_bot_info



#- story: status without incident number
#  steps:
#  - checkpoint: connected
#  - or:
#    - intent: claim_status_consultant_direct
#    - intent: claim_status_manager_message
#    - intent: claim_status_bot_info
#  - action: action_set_status_path
#  - action: utter_give_incident_number
#  - intent: inform
#  - action: action_verify_incident_number
#  - slot_was_set:
#    - incident_number: null
#  - action: utter_status_transfer

